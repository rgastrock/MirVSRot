---
title: "Mirror reversal VS Rotation: Comparing motor adaptation and de novo learning"
author: "Raphael Gastrock"
output:
  html_document:
    toc: TRUE
    toc_depth: 4
    toc_float: true
---


# Overview

This document discusses results for the tablet and online experiments, with both Bayesian and frequentist analyses. We also  show additional figures and statistics.

# Set up the R enviornment

We have written code that pre-processes the data, plots figures, and runs statistical tests. Import the sources below:

```{r message=FALSE, warning=FALSE}
source('ana/shared.R')
#tablet experiment scripts
source('ana/ordereffects.R')
source('ana/learningRates.R')
source('ana/exponentialandstepModel.R')
source('ana/individualDataCheck.R')
source('ana/rae.R')
source('ana/RTandMT.R')
source('ana/pathlength.R')
#online experiment scripts
source('ana/controlmir.R')
source('ana/controlmirgen.R')
source('ana/su&fa2020online.R')
source('ana/qualtricsdata.R')
source('ana/mironline_fa2020.R')
source('ana/mirgeneralization_fa2020.R')
```

# Study 1: Tablet experiment results

For the tablet experiment, half of the participants (N = 16) were simply told to compensate for the cursor moving differently during perturbed reaches, and the other half (N = 16) were instructed about the nature of each perturbation and was given a strategy to counter for it. We focus on the non-instructed participants for most of the analyses, as we only wanted to observe the effects of instructions on initial learning in each perturbation for the instructed participants.

## Order Effects

Given that we implemented a within-subjects design for the tablet experiment, we first test whether learning one perturbation has an effect on learning the other. We also test for any effects in learning, depending on which axis each perturbation was experienced and the target locations relative to the perturbation axis.

### Perturbation order
#### Rotation

For perturbation order, we expect that learning in each perturbation should not affect the other, regardless of which perturbation the participant experienced first.

```{r}
plotNIROTOrderEffects()
```

For non-instructed participants, the percentage of compensation did not differ regardless of whether the rotation perturbation was experienced before or after mirror reversed perturbed reaches.

To quantify these comparisons between conditions better, we fit an exponential decay function that allowed us to measure learning rates and learning asymptotes. For perturbation order, we fit the exponential function to participants that either experienced the rotation before or after mirror reversed reaches.

```{r, warning=FALSE}
plotROTOrderEffectsModel(group='noninstructed')
```

We then conducted t-tests to compare the learning rates and asymptotes between the two order conditions. Both frequentist and Bayesian tests are reported below.

```{r}
getLambdaOrderEffectsTTest(perturbation='ROT')
getAsymptoteOrderEffectsTTest(perturbation='ROT')
```

The tests confirmed that learning rates and learning asymptote did not differ regardless of whether the rotation was experienced before or after the other perturbation.

#### Mirror reversal

```{r}
plotNIMIROrderEffects()
```

For the mirror reversed perturbed reaches, we also do not find differences depending on the order that they experienced the perturbation. However, note that the percentages of compensation have larger variability compared to those in the rotation perturbation.

We fit the same exponential decay function to both conditions and conducted t-tests to compare learning rates and asymptotes between perturbation order conditions.

```{r, warning=FALSE}
plotMIROrderEffectsModel(groups='noninstructed')

```

We did not find any differences in learning rates and asymptotes between the mirror perturbation order conditions.

```{r}
getLambdaOrderEffectsTTest(perturbation='MIR')
getAsymptoteOrderEffectsTTest(perturbation='MIR')
```

##### Model comparisons

Since the mirror reversal data had more variability, we wanted to investigate whether different functions will fit the data better. For some participants, compensation seemed to immediately become better after a few trials. That is, it seemed like they figured things out after a certain trial, and suddenly started to perform better. The nature of such a performance resembled a logistic or step function. Therefore, in addition to the exponential decay function, we also fit both step and logistic functions to the rotation and mirror reversed data for each participant. 

For the exponential decay function we get two parameters: lambda for the learning rate, and N0 for the asymptote.
For the step function, instead of a learning rate, we get a step parameter to indicate where the change occurs. We also get an asymptote parameter.
For the logistic function we get three parameters: x0 (the steepest part of the logistic function), k (the inverse of the steepness of the logistic function), and L (the scale of the function, which starts at 0 (at -infinity) and reaches L at infinity).

After fitting each function to each participant's data, we also calculate mean squared errors (MSE) between each function and the data. The parameters and MSEs for the rotation perturbation are shown below. Each row will correspond to one participant.

```{r}
read.csv('data/pilot/ROT_noninstructed_MSE_ordereffects.csv')
```

The parameters and MSEs for the mirror reversed perturbation are shown below:

```{r}
read.csv('data/pilot/MIR_noninstructed_MSE_ordereffects.csv')
```

We then use the MSEs to calculate AIC values and generate relative log-likelihoods for each participant. This produces values that we can compare across the three functions for each participant. The likelihoods are shown below. A value of 1 indicates the function with the best fit.

```{r}
read.csv('data/pilot/participant_model_likelihoods.csv')
```

We observe that for majority of participants, the exponential function fits their data best. While we have some participants that show that the step function fits their data best, these likelihoods are not significantly far off from likelihoods in the exponential function. Furthermore, when we pool data across participants and just compare likelihoods for each perturbation type, we observe that the exponential function is the best fit for the data.

```{r}
read.csv('data/pilot/all_model_likelihoods.csv')
```

Thus, we use the exponential function to compare learning rates and asymptotes between order effects conditions, and to compare rotation and mirror reversal perturbations.

### Perturbation Axis

Next, we tested for any effects depending on which axis each perturbation was experienced. That is, we compared learning rates and asymptotes between half of the participants that experienced the rotation/mirror reversal on the vertical midline axis, with the other half that experienced the rotation/mirror reversal on the horizontal axis.

#### Rotation

```{r}
plotNIROTAxisEffects()
```

```{r}
getLambdaAxisEffectsTTest(perturbation = 'ROT')
getAsymptoteAxisEffectsTTest(perturbation = 'ROT')
```

There are no axis effects, regardless of whether the perturbation is experienced on the horizontal or vertical axis of the workspace.

#### Mirror reversal

We also test for axis effects with the mirror reversed perturbation.

```{r}
plotNIMIRAxisEffects()
```

```{r}
getLambdaAxisEffectsTTest(perturbation = 'MIR')
getAsymptoteAxisEffectsTTest(perturbation = 'MIR')
```

We also do not find axis effects for the mirror reversal perturbation.

### Target location relative to axis

There were six targets for each axis. Three of the six targets were on either end of the axis, but could be on its negative (before axis) or positive (after axis) side.

#### Rotation

```{r}
plotNIROTTargetEffects()
```

For the statistical tests, we calculated a sign flip for targets that required a negative amount of compensation, such that we only compared the magnitude of the compensation. These values were then used to generate the exponential function fit parameters.

```{r}
getLambdaTargetEffectsTTest(perturbation = 'ROT')
getAsymptoteTargetEffectsTTest(perturbation = 'ROT')
```

We do not find any differences between learning rates and asymptotes, suggesting that there are no target location effects.

#### Mirror

```{r}
plotNIMIRTargetEffects()
```

We again calculated a sign flip for targets that required a negative amount of compensation, then used these values to generate the exponential function fit parameters.

```{r}
getLambdaTargetEffectsTTest(perturbation = 'MIR')
getAsymptoteTargetEffectsTTest(perturbation = 'MIR')
```

We do not find any conclusive evidence of differences between learning rates and asymptotes.

## Learning Rates

As learning in the two perturbation types is independent of one another, we can then compare the progression of learning across trials between the rotation and mirror tasks. For the plots below, the y-axis will be the amount of compensation in percentage. This is because while the rotation magnitude is consistently 30-degrees, angular reach deviations for the mirror will differ depending on the target distance from the mirror axis. The mirror task will require reach deviations of 15, 30, or 45 degrees. Here, 100% would mean perfect compensation, 0% would be no compensation or reaching directly to the target, and negative values are compensations in the wrong direction relative to the target.

```{r}
plotPTypeLearningCurves(group='noninstructed')
```

We observe that although participants learned to compensate for both perturbation types, learning in the mirror reversed perturbation had a larger variability. We look into this further and show individual performance across blocks of six trials each.

```{r}
plotCollapsedBlockedIndLC(group = 'noninstructed')
```

To compare learning between the two perturbation types, we fit the exponential decay function to data for each perturbation type. The function produced two measures, a rate of change and asymptote of learning. We then conducted a t-test to compare both measures between the two perturbation types.

```{r}
getLambdaLearningCurvesTTest()
getAsymptoteLearningCurvesTTest()
```

We do not find an effect for the rate of change in learning, suggesting no difference in the progression of learning between the two perturbation types. However, we do find an effect in the asymptote of learning, suggesting that learning asymptote for the mirror reversal was higher than in the rotation.

### Supplementary: Learning across three mirror target locations

Given the variability in learning for the mirror reversed perturbation, we investigated whether learning was dependent on the three different target locations. 

First, we looked into the overall distribution of percentages of compensation per target location.

```{r}
getTargetCurveVioplots(group='noninstructed', maxppid=15, location='maxvel')
```

The distributions are overall as expected, i.e. there were no bimodal distributions. We then plot angular reach deviations per target location.

```{r}
plotNIMIRTargetCurve()
```

Although participants learned to compensate for all three target locations, it seems that variability for the target near the mirror axis (15 degrees) is larger. Therefore, we conducted the same analyses as in the previous section but removed all targets where participants had to deviate by 15 degrees.

```{r}
plotPTypeLearningCurvesWONear()
```

Removing the 15 degree targets produced less variability, but learning in the mirror reversal still had a larger variability than the rotation.

```{r}
getLambdaLearningCurvesWONearTTest()
getAsymptoteLearningCurvesWONearTTest()
```

We conducted the same t-tests to compare learning rates and asymptotes between the two perturbation types. We found that after removing the 15 degree target, there are no effects in rate and asymptote, suggesting that the 15 degree target contributed to higher asymptotes in learning the mirror reversed perturbation. 

## Reach aftereffects

We then use washout trials following perturbation training to investigate whether reach aftereffects are observed. We expected to observe reach aftereffects following rotation training, but not mirror reversal training.

```{r}
plotPTypeAftereffects()
```

We can also show individual performance across blocks of six trials each.

```{r}
plotCollapsedBlockedIndRAE()
```

We observe aftereffects following rotation training but not after mirror reversal training. This is supported by looking into the individual targets for the mirror reversal. Angular reach deviations show that the rate of de-adaptation is around zero across washout trials.

```{r}
plotNIRAETargetCurve()
```

It is possible to fit an exponential decay function to the washout data, where it starts at the asymptote and approaches zero over time. The exponential function can be fit into washout trials following rotation training. However, given that the washout trials after mirror reversal training are around zero, it would not make sense to fit the function to this data. 

```{r}
plotROTRAEModel(groups='noninstructed')
plotMIRRAEModel(groups='noninstructed')
```

We therefore confirmed the presence of reach aftereffects by comparing the percentages of compensation during the last block of aligned reaches with the first block of each of the corresponding washout trials after rotated and mirror reversed training.

```{r}
RAEt.test(group='noninstructed')
```

We find an effect between aligned and rotated blocks, but not between aligned and mirror reversed blocks, confirming our expectations that aftereffects are only observed following rotation training. Moreover, we find an effect between the first washout blocks following rotation and mirror reversed training. We then compared the corresponding washout trials of rotation and mirror reversed training during the first, second, and last blocks of trials (trials 1-6, 7-12, 43-48). 

```{r}
reachaftereffectsANOVA(group='noninstructed')
reachaftereffectsBayesANOVA(group='noninstructed')
```

We find a significant perturbation type by block interaction. 

```{r}
RAEComparisonsAllBlocksEffSize(group='noninstructed')
reachaftereffectsBayesfollowup(group='noninstructed')
```

Follow up tests confirm that the first and second rotation washout blocks are different from the first and second mirror washout blocks.

### Supplementary: Training rate of learning and its association with aftereffects

We also wanted to test whether learning rates during training correlate to the aftereffects, or lack thereof, during washout trials. To do this, we conducted correlation tests that compared the rate of change during learning with the compensation percentages during the first block of washout trials.

```{r}
getLambdaRAECorrelations(group='noninstructed')
```

We do not find significant relationships between learning rates and corresponding aftereffects.

## Movement analyses

We compared other behavioral measures associated with reaching movements in both perturbation types.

### Reaction time

We defined reaction time (RT) as the time elapsed between the go signal onset and when the hand-cursor has moved 0.5 cm away from the start position.

```{r}
plotNIBlockedRT()
```

To quantify changes in RT across rotation and mirror reversed training, we conducted t-tests to compare RTs in the last block of aligned reaches with the RTs in the first and last blocks of rotation or mirror reversed reaches. We also conducted t-tests to compare RTs in the last block of aligned reaches with the RTs in the first blocks of washout reaches following each perturbation training.

```{r}
RTt.test(group='noninstructed')
```

As expected, participants were slower in initiating movements in the first block of perturbation training, regardless of the perturbation type. However, we do see in the plot that participants were slower to initiate movements in mirror reversed reaches compared to rotated reaches. RTs taper off and go back to baseline levels for rotated reaches, but is still significantly slower than baseline levels for mirror reversed reaches at the end of training. There are no effects between aligned and washout reaches.

We also compared RTs between rotation and mirror reversed reaches across training trials.

```{r}
reactiontimeANOVA(group='noninstructed')
RTBayesANOVA(group='noninstructed')
```

We find a significant perturbation type by block interaction.

```{r}
RTComparisonsAllBlocksEffSize(group='noninstructed')
RTBayesfollowup(group='noninstructed')
```

Follow up tests show that rotation and mirror reversed RTs differed during the first and second blocks of training, and Bayesian tests showed anecdotal evidence of an effect between perturbation RTs in the last block of training. Overall, this shows that movement initiation is slower during mirror reversed perturbed reaches, compared to rotation perturbation reaches.


### Movement time

We defined movement time (MT) as the time elapsed between the first sample when the hand-cursor is >0.5 cm away from the start position and the first sample when the hand-cursor is greater than the start-to-target distance

```{r}
plotNIBlockedMT()
```

To quantify changes in MT across rotation and mirror reversed training, we conducted the same t-tests as in the reaction time analysis. We compared MTs in the last block of aligned reaches with the MTs in the first and last blocks of rotation or mirror reversed reaches. We also conducted t-tests to compare MTs in the last block of aligned reaches with the MTs in the first blocks of washout reaches following each perturbation training.

```{r}
MTt.test(group='noninstructed')
```

Participants were faster in executing movements during rotated reaches, compared to aligned baseline reaches. Interestingly, faster MTs were also observed in the first block of washout trials following rotation training. In contrast, MTs do not differ between aligned reaches and the first block of mirror reversed reaches or its corresponding washout trials. However, we do find faster MTs during the last block of mirror reversed reaches, when compared to aligned reaches.

We also compared MTs between rotation and mirror reversed reaches across training trials.

```{r}
movementtimePerturbANOVA(group='noninstructed')
MTBayesANOVA(group='noninstructed')
```

We do not find any main or interaction effects for perturbation type and block. Therefore, even though movement initiation was slower for both perturbed reaches, movement execution was faster for the rotated reaches. Mirror reversed movement times eventually became faster than aligned reaches by the end of perturbation training. This supports the idea that more explicit processes contribute to learning the mirror reversal, as both movement initiation and execution are slower for these reaches compared to rotation pertubation reaches.

### Path length

We defined path length (PL) as the total distance, given x and y coordinates of the reach trajectory, traveled between movement onset and offset. Movement onset and offset are the start and end movement times defined in the previous section. The shortest path length to the target is a straight line spanning the start-to-target distance. However, movements are not perfectly straight and may travel in different directions, depending on the perturbation. 

```{r}
plotNIBlockedPL()
```

Similar to the other measures above, we conducted t-tests to compare PLs between the last block of aligned trials with the first and last blocks of rotation and mirror reversed training. We then compared PLs between the two perturbation types.

```{r}
PLt.test(group='noninstructed')
pathlengthPerturbANOVA(group='noninstructed')
PLBayesANOVA(group='noninstructed')
```

We do not find any effects across all comparisons, suggesting that the path of reach trajectories did not differ regardless of trial type or perturbation type.

## Instructed participants

For the instructed participants, we told them about the nature of each perturbation. We let them know that the rotation will be 30-degree rotation (CW or CCW depending on their ID), and that the mirror reversal will be dependent on which axis the mirror is placed. We also showed them animations of how to compensate for each perturbation type, and tested their understanding of the strategy by having them draw on a clock-face the location that they should move to bring a cursor to the target. For example, if the target is at 2 o'clock, then they had to draw an arrow to 1 o'clock to correct for a 30 degree CW rotation. In contrast, for a mirror placed along the vertical midline, a target at 2 o'clock would mean that they had to draw an arrow to the 10 position. We know from previous work that such instructions provide an advantage in early learning for rotation perturbations, and we wanted to test whether the same advantage will be observed for the mirror reversal.

```{r}
plotPTypeLearningCurves(group='instructed')
plotCollapsedBlockedIndLC(group='instructed', maxppid=31)
```

We find that instructions did provide an advantage during the first few trials of training for both perturbation types, and that participants were immediately performing around perfect compensation. There was no change in learning across training, but we do find that mirror reversed reaches showed more variability.

### Reach aftereffects

We then investigated the corresponding washout trials for the instructed participants.

```{r}
plotPTypeAftereffects(group='instructed')
plotCollapsedBlockedIndRAE(group='instructed', maxppid=31)
```

We repeated the reach aftereffects analyses we conducted for non-instructed participants with the instructed participants.

```{r}
RAEt.test(group='instructed')
```

The first block of washout trials following rotation training differed from the last block of aligned baseline reaches, suggesting the presence of aftereffects. Interestingly, we also find an effect when comparing the first block of washout trials following mirror reversed reaches with aligned reaches. However, aftereffects were larger for washout trials following rotation training, than those following mirror reversed training. The presence of very small aftereffects in the mirror reversal washout trials is unexpected, but could be due to being able to know how to compensate for the perturbation from the beginning of training. That is, they were exposed to training with the mirror reversal longer than the non-instructed participants.

We compare rotation and mirror reversed washout trials further.

```{r}
reachaftereffectsANOVA(group='instructed')
reachaftereffectsBayesANOVA(group='instructed')
```

We find a significant perturbation type by block interaction.

```{r}
RAEComparisonsAllBlocksEffSize(group='instructed')
reachaftereffectsBayesfollowup(group='instructed')
```

Follow up tests show that compensation in rotation washout trials were larger in the first and second blocks, compared to mirror reversed washout trials. Overall, it is clear that aftereffects observed following rotation training are larger than those observed following mirror training.

### Movement analyses

We also compared other behavioral measures associated with reaching movements in both perturbation types for the instructed participants.

#### Reaction time

We defined reaction time (RT) as the time elapsed between the go signal onset and when the hand-cursor has moved 0.5 cm away from the start position.

```{r}
plotIBlockedRT()
```

To quantify changes in RT across rotation and mirror reversed training, we conducted t-tests to compare RTs in the last block of aligned reaches with the RTs in the first and last blocks of rotation or mirror reversed reaches. We also conducted t-tests to compare RTs in the last block of aligned reaches with the RTs in the first blocks of washout reaches following each perturbation training.

```{r}
RTt.test(group='instructed')
```

The results are similar to those with the noninstructed participants. Participants were slower in initiating movements in the first block of perturbation training, regardless of the perturbation type. However, we do see in the plot that participants were slower to initiate movements in mirror reversed reaches compared to rotated reaches. RTs taper off and go back to baseline levels for rotated reaches, but is still significantly slower than baseline levels for mirror reversed reaches at the end of training. There are no effects between aligned and washout reaches.

We also compared RTs between rotation and mirror reversed reaches across training trials.

```{r}
reactiontimeANOVA(group='instructed')
RTBayesANOVA(group='instructed')
```

We find main effects for perturbation type and block.

```{r}
RTComparisonsAllBlocksEffSize(group='instructed')
RTBayesfollowup(group='instructed')
```

Follow up tests show that rotation and mirror reversed RTs differed across block of training. Overall, this confirms that movement initiation is slower during mirror reversed perturbed reaches, compared to rotation perturbation reaches.


#### Movement time

We defined movement time (MT) as the time elapsed between the first sample when the hand-cursor is >0.5 cm away from the start position and the first sample when the hand-cursor is greater than the start-to-target distance

```{r}
plotIBlockedMT()
```

To quantify changes in MT across rotation and mirror reversed training, we conducted the same t-tests as in the reaction time analysis. We compared MTs in the last block of aligned reaches with the MTs in the first and last blocks of rotation or mirror reversed reaches. We also conducted t-tests to compare MTs in the last block of aligned reaches with the MTs in the first blocks of washout reaches following each perturbation training.

```{r}
MTt.test(group='instructed')
```

Contrary to our findings with noninstructed participants, we found no effects for movement times across the different trial types for instructed participants.

We also compared MTs between rotation and mirror reversed reaches across training trials.

```{r}
movementtimePerturbANOVA(group='instructed')
MTBayesANOVA(group='instructed')
```

We find a main effect of block.

```{r}
MTPerturbComparisonsAllBlocksEffSize(group='instructed')
MTBayesfollowup(group='instructed')
```

Follow up tests show that the block effect is driven by changes within rotation MTs across blocks of trials. However, this is not supported with Bayesian tests. Thus, there are no differences in MTs between the two perturbation types.

#### Path length

We defined path length (PL) as the total distance, given x and y coordinates of the reach trajectory, traveled between movement onset and offset. Movement onset and offset are the start and end movement times defined in the previous section. The shortest path length to the target is a straight line spanning the start-to-target distance. However, movements are not perfectly straight and may travel in different directions, depending on the perturbation. 

```{r}
plotPTypePathLength(group='instructed')
```

Interestingly, we find that there is less PL variability in mirror reversed reaches for instructed participants compared to those observed with noninstructed participants. This suggests that they used the instructions to move in an optimal manner towards the target. Similar to the other measures above, we conducted t-tests to compare PLs between the last block of aligned trials with the first and last blocks of rotation and mirror reversed training. We then compared PLs between the two perturbation types.

```{r}
PLt.test(group='instructed')
pathlengthPerturbANOVA(group='instructed')
PLBayesANOVA(group='instructed')
```

We find a significant perturbation type by block interaction, but only in the frequentist test.

```{r}
PLPerturbComparisonsAllBlocksEffSize(group='instructed')
```

Following up on the frequentist test does not reveal any effects. Thus, we conclude that path lengths do not differ across trial types and between perturbation types.


# Study 2: Online experiment results

The online experiment consisted of two sessions. In the first session, participants (N = 63) trained with the mirror reversal perturbation in a browser-based task, while using their dominant hand to control either their mouse or trackpad. They then returned for a second session (N = 48), where they immediately had to complete the same mirror reversed reaches, so that we may test for retention. We then tested for generalization by having participants complete mirror reversed reaches to different target locations across the workspace, and with their untrained/ non-dominant hand.

Target locations were either 5 degrees, 45 degrees, or 85 degrees away from a mirror axis placed along the vertical midline. We refer to these as near, middle, and far targets respectively.

## Session 1

The first session began with 45 trials of aligned reaches with the participants' dominant hand. Then they switched to using their non-dominant hand to complete 21 trials of aligned reaches. We then instructed them to switch back to using their dominant hand to complete 90 mirror reversed trials. Finally, they completed 21 trials of washout trials using their trained/ dominant hand.

### Learning

We observe really fast learning in the online paradigm (see also supplementary R notebook), which is due to participants exploring the workspace during the very first trial. Regardless, participants learned to compensate for the mirror reversal in each of the target locations accordingly.

```{r}
plotBlockedMirCtrl()
```

Before comparing learning across the three target locations, we first tested whether reaching performance in aligned reaches differed depending on the hand used to control the cursor. Thus we took the aligned reaches from each hand, and compared the first, second, and last block of reaching trials (trials 1-9, 10-18, 37-45 for the dominant hand, trials 46-48, 49-51, 64-66 for the nondominant hand) to the three target locations. We conducted a 3x3x2 (target x block x hand) within-subjects ANOVA.

```{r}
alignedLearningANOVA2Hands()
alignedLearning2HandsBayesANOVA()
```

We do not find an effect for the hand used, suggesting that aligned reaching performance is not different regardless of which hand was used.

Next, given that we observe fast learning, we cannot fit the exponential function to this data and generate reliable measures of learning rate and learning asymptote. Instead, we compare reaching performance to the three target locations across the first, second, and last few blocks of training trials (trials 1-3, 4-6, 76-90). We conduct a 3x3 (target x block) within-subjects ANOVA. We converted the angular reach deviations to percentage of compensation, such that the three target locations will be comparable.

```{r}
mirrorANOVA()
mirrorBayesANOVA()
```

We do not find any effects, suggesting that reaching performance did not differ across the the three target locations throughout training.

Given the large inter-participant variability observed with the near target, we also repeat the analyses without the near target, to investigate differences in percentage of compensation between the far and middle targets.

```{r}
mirrorANOVA(groups=c('far', 'mid'))
mirrorBayesANOVA(groups=c('far', 'mid'))
```

We find no target effect, but do find a significant target by block interaction. However, the interaction does not hold up under the Bayesian test. Regardless, follow-up tests comparing the far and middle target across blocks show only a small difference during the last block, where compensation was higher for the far target.

```{r}
mirrorNoNearTargetComparisonMeans()
mirrorNoNearTargetComparisonsEffSize()
mirrorNoNearTargetBayesfollowup()
```


### Reach aftereffects

From the plot, we do not observe evidence of reach aftereffects in all targets. To quantify this, we compared the first two blocks of trials during washout (trials 1-3, 4-6) with aligned reaches to the three targets. We conducted a 3x3 (block x target) within-subjects ANOVA.

```{r}
RAETrainedTargetsANOVA(groups = c('far', 'mid'))
RAETrainedTargetsBayesANOVA(groups = c('far', 'mid'))
```

We do not find any effects when comparing percentages for the far and middle targets.

### Movement analysis

We then repeated the same set of tests we conducted for learning and reach aftereffects, but with completion time and path length as the dependent variables.

#### Completion time

In the online study, the target for the next trial was shown as soon as the cursor acquired the start position. This meant that participants made movements towards the centre of the start position, before moving in the direction of the target again. As such, defining RTs would produce unreliable measures. We instead defined completion time, as the time elapsed between target onset and target acquisition (i.e., includes both RT plus MT). 

```{r}
plotCtrlMT()
```

We observe that completion time seems to be longer at the start of every trial type, and becomes faster as the trials progress. Therefore, in aligned reaches, we first test for an effect of target or block while participants used either their dominant or non-dominant hand. We conduct a 3x3 (target x block) within-subjects ANOVA for the dominant hand, and conduct the same test for aligned trials using the non-dominant hand.

```{r}
alignedMTANOVA()
alignedMTBayesANOVA()
```

We find main effects of target and block for the trained hand, and a main effect of block for the untrained hand. The effect of block is expected, given that completion time becomes faster as trials progress. We investigate the target effect in the trained hand further.

```{r}
trainedHandMTComparisonMeansTargetEffect()
trainedHandMTComparisonsEffSizeTargetEffect()
trainedHandMTTargetEffectBayesfollowup()
```

Follow up frequentist tests show that the target effect is driven by a difference between the far and middle target. However, this difference is small and does not hold up in Bayesian t-tests. This may suggest that perhaps movements towards the far target are faster to initiate and execute.

Since we have confirmed these patterns within each hand's aligned trials, we then test for an effect of hand used in completion time with a 3x3x2 (target x block x hand) within-subjects ANOVA.

```{r}
alignedMTANOVA2Hands()
alignedMT2HandsBayesANOVA()
```


We find a main effect of hand. 

```{r}
MTComparisonsHandEffect()
```

Follow-up tests suggest that completion time in the trained (dominant) hand is faster than in the untrained (nondominant) hand.

Next, we conduct a 3x3 (target x block) within-subjects ANOVA to test for completion time effects during the mirror reversed trials.

```{r}
mirrorMTANOVA()
mirrorMTBayesANOVA()
```

We find a significant block by target interaction.

```{r}
mirrorMTComparisonMeans()
mirrorMTComparisonsEffSize()
mirrorMTBayesfollowup()
```

Follow-up tests show faster completion times for the far target compared to the middle target across all three blocks. The far target is also faster than the near target for the last block. These results suggest that movement initiation and execution towards the far target is faster than the other two targets.

We also compare the first and last block of training CTs to those in the aligned trials. We conduct t-tests comparing each block:

```{r}
LearningMTTrainedTargetsBayestTest()
```

We find that CTs do not go back to baseline by the end of training, but are comparable to those in baseline.

For washout trials, we first conduct a 3x2 (target x first and second block) within-subject ANOVA, to test for any effects across target locations.

```{r}
RAEMTANOVA()
RAEMTBayesANOVA()
```

We find main effects of target and block, but no interaction.

```{r}
RAEMTComparisonsEffSizeTargetEffect()
RAEMTTargetEffectBayesfollowup()
```

Follow-up tests show that the target effect is driven by a difference between the far and near targets, but these differences are small and do not hold up in Bayesian tests.

Now that we have confirmed these patterns, we can now compare washout trials with those in aligned to test for completion time effects between aligned and washout trials. We conduct a 3x3 (target x block) within-subjects ANOVA, where block considers the aligned trials, first, and second block of washout trials.

```{r}
RAEMTTrainedTargetsANOVA()
RAEMTTrainedTargetsBayesANOVA()
```

We find main effects of block and target, but no interaction. We then conduct follow-up tests on the block effect, regardless of target location.

```{r}
RAEMTTrainedTargetsComparisonMeans()
RAEMTTrainedTargetsComparisonsEffSize()
RAEMTTrainedTargetsBlockEffectBayesfollowup()
```

We find that the main effect of block is driven by a difference between the two blocks during washout, given that completion time is faster as trials progress. Overall, completion time during washout trials do not differ from completion times during aligned reaches.

#### Path length

We repeat the same set of analyses for completion time, with path lengths. We defined path lengths similar to how we defined it for the tablet study. In the online study, the shortest path from start to target is 0.4 height units (scaled to participant monitor size).

```{r}
plotCtrlPL()
```

For aligned reaches, we first test for an effect of target or block while participants used either their dominant or non-dominant hand. We conduct a 3x3 (target x block) within-subjects ANOVA for the dominant hand, and conduct the same test for aligned trials using the non-dominant hand.

```{r}
alignedPLANOVA()
alignedPLBayesANOVA()
```

We find a main effect of target for the trained hand, and a main effect of block for the untrained hand. From the plot, we observe that the path lengths become shorter as aligned reaches progress with the untrained/nondominant hand. Thus, we conduct follow up tests for the main effect of target in the trained hand.

```{r}
trainedHandPLComparisonMeansTargetEffect()
trainedHandPLComparisonsEffSizeTargetEffect()
trainedHandPLTargetEffectBayesfollowup()
```

The target effect is driven by a difference between middle and near target path lengths.

Next, we can compare the two aligned trials between the trained and untrained hands. We conduct a 3x3x2 (target x block x hand) within-subjects ANOVA.

```{r}
alignedPLANOVA2Hands()
alignedPL2HandsBayesANOVA()
```

We find a main effect of hand.

```{r}
PLComparisonsHandEffect()
```

Follow-up tests comparing PLs in the two hands suggest that path lengths were longer for the untrained/ nondominant hand.

We then conducted a 3x3 (target x block) within-subjects ANOVA for path lengths during the mirror reversed trials.

```{r}
mirrorPLANOVA()
mirrorPLBayesANOVA()
```

We find a significant target by block interaction.

```{r}
mirrorPLComparisonMeans()
mirrorPLComparisonsEffSize()
mirrorPLBayesfollowup()
```

Follow-up tests show that the far target had shorter path lengths than the middle target across block of trials. The far target also had a shorter path length than the near target during the end of learning. Finally, the near target had shorter path lengths that the middle target for the first two blocks. Taken together, these results suggest that path lengths were shortest for the far target, and longest for the middle target.

We also compare the first and last block of training PLs to those in the aligned trials. We conduct t-tests comparing each block:

```{r}
LearningPLTrainedTargetsBayestTest()
```

We find that PLs do not go back to baseline by the end of training, but are comparable to those in baseline.

For washout trials, we first conduct a 3x2 (target x first and second block) within-subjects ANOVA to investigate effects across target locations.

```{r}
RAEPLANOVA()
RAEPLBayesANOVA()
```

We find a main effect of block, which is already evident from the plot.

Next, we conducted a 3x3 (target x block) within-subjects ANOVA, to test for target effects across the aligned trials, first and second blocks of washout trials.

```{r}
RAEPLTrainedTargetsANOVA()
RAEPLTrainedTargetsBayesANOVA()
```

We find a main effect of block.

```{r}
RAEPLTrainedTargetsComparisonMeans()
RAEPLTrainedTargetsComparisonsEffSize()
RAEPLTrainedTargetsBlockEffectBayesfollowup()
```

However, follow-up tests show that the block effect is driven by the first block of washout trials having larger path lengths than in block 2 or aligned trials. This is likely due to switching from mirror reversed trials directly to washout trials. Overall, the path length results support results from the analysis with completion time.

## Session 2

In session 2, we tested for retention and generalization across the workspace and hands. As such, the three possible target locations (far, middle, near) were positioned in either quadrant 1 (5°, 45°, or 85° in polar coordinates), quadrant 2 (95°, 135°, or 175° in polar coordinates), or quadrant 4 (275°, 315°, or 355° in polar coordinates), relative to the mirror axis along the vertical midline. 

Participants returned on a different day, and immediately performed 21 trials of mirror reversed reaches to quadrant 1 targets using their dominant or trained hand. They then completed 21 trials of perturbed reaches to quadrant 4 targets followed by 21 trials to quadrant 2 targets. To prevent any possible decay in learning, we had them perform another 21 trials of perturbed reaches to quadrant 1 targets. Finally, we instructed them to switch to their non-dominant hand, and perform 21 trials of perturbed reaches to quadrant 1 targets. The session ended with participants completing 21 washout trials with their non-dominant/ untrained hand.

### Performance for the three targets across quadrants

First, we plot a distribution for when participants returned for the second session.

```{r}
plotCtrlDaysApart()
```

Majority of participants returned after 3 to 4 days (mean = 4.77, SD = 2.52, median = 4 days apart), with a few returning after more than two weeks.

At the start of the session, we observe that participants are able to compensate for the mirror reversed perturbation quickly. This learned performance also seems to transfer well to the targets in other quadrants, as well as to the untrained hand.

```{r, fig.width = 16, fig.height = 10}
plotBlockedLearningCtrlGen()
```

#### Learned performance

Before testing for retention and generalization, we first tested for target or block effects for reaches within each quadrant. Thus, we conducted 3x3 (target x block) within-subjects ANOVA for quadrants 1, 4, 2, top-up trials in quadrant 1 (Quadrant 1A in tests below), and quadrant 1 after switching hands (Quadrant 1L in tests below).

```{r}
learningANOVA()
learningBayesANOVA()
```

In all tests, we only find a main effect of target for reaches in quadrant 4. 

```{r}
quadrant4ComparisonsEffSize()
quadrant4ComparisonsBayesfollowup()
```

Follow-up tests show that the effect is driven by the difference between middle and near targets, regardless of block. This confirms what we observe in the plot above, where compensation percentages for the near target are easily overcompensated.

#### Retention

To quantify retention, we compare the learned performance between the first and last blocks of mirror reversed reaches in session 1 (blocks 1, 26-30), with the first block of mirror reversed reaches in session 2.

```{r}
retentionANOVA()
retentionBayesANOVA()
```

We find no effects of target and block, suggesting that reaching performance did not differ across the start and end of session 1 and with the beginning of session 2. We note however, that this lack of an effect is likely due to the large inter-participant variability for the near target. Thus, we repeat the analyses with only the far and middle targets.

```{r}
retentionANOVA(groups=c('far', 'mid'))
retentionBayesANOVA(groups=c('far', 'mid'))
```

Here, we find a block effect, suggesting that percentages differed across training blocks in session 1 and 2.

```{r}
retentionComparisonMeans(groups=c('far', 'mid'))
retentionComparisonsEffSize(groups=c('far', 'mid'))
retentionComparisonsBayesfollowup(groups=c('far', 'mid'))
```

Follow-up tests show that the block effect is driven by a difference between the last block of training in session 1, with both the first blocks of training in the two sessions. Notably, we find no difference between the first blocks in the two sessions. 

```{r}
retentionAsymptoteComparisons()
```

When taking the mean compensations in each block, and calculating them as a percentage relative to the compensation achieved at the end of session 1 training, we find that compensation is higher for the far target in the second session, but lower for the middle target in the second session. Thus, we cannot conclude that we are observing retention. However, we do find evidence for retention in our measures of completion time and path length.

#### Generalization across the workspace and hands

To quantify generalization, we compare reaching performance across quadrants. We conduct a 3x3 (target x block) within-subjects ANOVA to compare the first and last blocks of reaches to quadrant 1 with the first block of reaches in quadrant 4. We repeat this test but instead compare quadrant 1 with quadrant 2, quadrant 1 and reaches to quadrant 1 after switching hands (Quadrant 1L).

```{r}
#Quadrant 1 vs Quadrant 4
learningANOVA2Quads(quadrantA= '1', quadrantB = '4')
learningBayesANOVA2Quads(quadrantA= '1', quadrantB = '4')

#Quadrant 1 vs Quadrant 2
learningANOVA2Quads(quadrantA= '1', quadrantB = '2')
learningBayesANOVA2Quads(quadrantA= '1', quadrantB = '2')

#Quadrant 1 vs Switch hands, Quadrant 1
learningANOVA2Quads(quadrantA= '1', quadrantB = '1L')
learningBayesANOVA2Quads(quadrantA= '1', quadrantB = '1L')
```

We find no effects of target or block, suggesting that overall reaching performance did not differ regardless of target location or hand used. However, this could again be confounded by the large inter-participant variability for the near target. We repeat the analyses for only the far and middle targets.

```{r}
#Quadrant 1 vs Quadrant 4
learningANOVA2Quads(groups = c('far', 'mid'), quadrantA= '1', quadrantB = '4')
learningBayesANOVA2Quads(groups = c('far', 'mid'), quadrantA= '1', quadrantB = '4')

#Quadrant 1 vs Quadrant 2
learningANOVA2Quads(groups = c('far', 'mid'), quadrantA= '1', quadrantB = '2')
learningBayesANOVA2Quads(groups = c('far', 'mid'), quadrantA= '1', quadrantB = '2')

#Quadrant 1 vs Switch hands, Quadrant 1
learningANOVA2Quads(groups = c('far', 'mid'), quadrantA= '1', quadrantB = '1L')
learningBayesANOVA2Quads(groups = c('far', 'mid'), quadrantA= '1', quadrantB = '1L')
```


We find a block effect for all three tests conducted.

```{r}
QAandBComparisonMeans(quadrantA = '1', quadrantB = '4')
QAandBComparisonsEffSize(quadrantA = '1', quadrantB = '4')
QAandBComparisonsBayesfollowup(quadrantA = '1', quadrantB = '4')
```

In comparing reaches to quadrant 1 and quadrant 4 (test targets on the same side but lower on the workspace than training targets), we find no differences between the last block of reaches in the training quadrant and the first block of of reaches to the test quadrant. Both of these quadrants also differed from the first block of reaches to the training quadrant. This suggests generalization of learning to the test quadrant.

```{r}
QAandBComparisonMeans(quadrantA = '1', quadrantB = '2')
QAandBComparisonsEffSize(quadrantA = '1', quadrantB = '2')
QAandBComparisonsBayesfollowup(quadrantA = '1', quadrantB = '2')
```

When switching to targets on quadrant 2 (test targets on the opposite side of the mirror axis), we find no differences between the first block of reaches to the test quadrant with both first and last blocks of reaches to the training quadrant. Because of this lack of an effect, we are unable to conclude generalization.

```{r}
QAandBAsymptoteComparisons(quadrantA='1', quadrantB='2')
```

However, we see that relative to compensation during the last block of reaches to the training quadrant, compensation was higher for the first block of reaches to the testing quadrant.

```{r}
QAandBComparisonMeans(quadrantA = '1', quadrantB = '1L')
QAandBComparisonsEffSize(quadrantA = '1', quadrantB = '1L')
QAandBComparisonsBayesfollowup(quadrantA = '1', quadrantB = '1L')
```

Finally, when switching to controlling the cursor with the other hand while reaching to the same trained target locations, we find a difference between the first block of reaches with the untrained hand and the last block of reaches with the trained hand. However, we find no difference between the first block of reaches when comparing the trained and untrained hand. In fact both have lower compensation compared to the last block of reaches with the trained hand. This suggests a lack of generalization.

```{r}
QAandBAsymptoteComparisons(quadrantA='1', quadrantB='1L')
```

Moreover, we see that relative to compensation during the last block of reaches with the trained hand, compensation was higher for the first block of reaches to the trained hand than the untrained hand.

We can  also conduct tests comparing the first block of reaches with the untrained hand, to the first and last block of reaches in session 1.

```{r}
intermanualANOVA(groups=c('far','mid'))
intermanualBayesANOVA(groups=c('far','mid'))
```

We find a block effect.

```{r}
intermanualComparisonsEffSize(groups=c('far','mid'))
intermanualComparisonsBayesfollowup(groups=c('far','mid'))
```

We find higher compensation values for the last block of training in session 1, compared to the other two blocks.

#### Reach aftereffects for the untrained/ nondominant hand

First, we test for target or block effects within washout trials using the nondominant or untrained hand.

```{r}
washoutLearningANOVA()
washoutLearningBayesANOVA()
```

We find main effects of block and target, but no interaction. In the Bayesian test, we only find the effect of block.

```{r}
washoutComparisonsEffSize()
washoutComparisonsBayesfollowup()
```

Follow-up tests show that the effect of block is driven by the difference of the first block of washout trials with the other blocks. This confirms what we see in the plot, where initially participants are compensating in the first washout trial. However, this is likely due to task switching rather than aftereffects, as participants were not instructed that the perturbation has been turned off.

```{r}
washoutTargetEffectComparisonsEffSize()
washoutTargetEffectComparisonsBayesfollowup()
```

Follow-up tests on the target effect show that the middle target differs from the near target.

To test for reach aftereffects, we can compare reaching performance between perturbed reaches with the nondominant hand (Quadrant 1L) and washout trials (Quadrant 1W). We conduct a 3x3x2 (target x block x quadrant) within-subjects ANOVA.

```{r}
learningANOVA2Quads(quadrantA='1L', quadrantB='1W')
learningBayesANOVA2Quads(quadrantA='1L', quadrantB='1W')
```

We find a main effect of quadrant and a block by quadrant interaction in the frequentist test, but only find the main effect of quadrant in the Bayesian test. The main effect of quadrant is seen in the plot, where washout trials are near zero in compensation.

```{r}
Q1Land1WComparisonsEffSize()
Q1Land1WComparisonsBayesfollowup()
```

Follow-up tests on the block by quadrant interaction show that the last block of mirror reversed training differs from the second and last blocks of washout trials. The lack of a difference between the first washout block from the training block is likely due to task switching rather than aftereffects, as participants were not instructed that the perturbation has been turned off.

Finally, we compare the first and second blocks of washout trials with the last block of aligned baseline trials using the nondominant hand from the first session. We conduct a 2X3 (target x block) within-subjects ANOVA.

```{r}
RAEUntrainedHandANOVA(groups=c('far','mid'))
RAEUntrainedHandBayesANOVA(groups=c('far','mid'))
```

We find a main effect of block.

```{r}
untrainedHandSessionComparisonsEffSize()
untrainedHandSessionComparisonsBayesfollowup()
```

We find that the last block of baseline and the second washout block differ from the first block of washout. This is evident with how participants' reaches were deviated during the first trial of washout. However, the absence of deviations by the second trial suggest that there are no aftereffects. Deviations from the first trial are only due to directly switching tasks between perturbed and aligned trials without any breaks in between.

### Movement analysis

We then repeat the same set of tests but instead use completion time and path length as the dependent variables.

#### Completion time

```{r}
plotCtrlGenMT()
```

##### Learned performance

We first tested for target or block effects for completion time within each quadrant. Thus, we conducted 3x3 (target x block) within-subjects ANOVA for quadrants 1, 4, 2, top-up trials in quadrant 1 (Quadrant 1A in tests below), quadrant 1 after switching hands (Quadrant 1L in tests below), and washout (Quadrant 1W).

```{r}
movementtimeANOVA()
movementtimeBayesANOVA()
```

In quadrant 1, we find a significant target x block interaction. We know from the plot that completion time decreases across blocks. Thus, it is more interesting to test for target differences across the blocks of trials.

```{r}
quadrant1MTComparisonsEffSize()
quadrant1MTComparisonsBayesfollowup()
```

Follow-up tests show that the completion time for the far target is faster compared to the middle target in all blocks, and faster compared to the near target in the second and last blocks. Completion time was also faster for the near target compared to the middle target in the first block. This suggests that movement initiation and execution was fastest for the far target  and slowest for the middle target.

For quadrants 4, 2 and top-up trials to quadrant 1 (Quadrant 1A), we observe main effects of target. We also observe main effects of block for quadrant 4 and 2, but this is seen with the decrease of completion time from the plot.

```{r}
#quadrant 4
quadrant4MTComparisonsEffSizeTargetEffect()
quadrant4MTComparisonsTargetEffectBayesfollowup()
#quadrant 2
quadrant2MTComparisonsEffSizeTargetEffect()
quadrant2MTComparisonsTargetEffectBayesfollowup()
#quadrant 1 (top-up trials)
quadrant1AMTComparisonsEffSizeTargetEffect()
quadrant1AMTComparisonsTargetEffectBayesfollowup()
```

In all three quadrants, the target effect is accounted for by faster completion times for the far target, compared to the middle and near targets.

For completion times for reaches with the nondominant hand (Quadrant 1L), we find main effects of block and target. We follow up on the target effect.

```{r}
quadrant1LMTComparisonsEffSizeTargetEffect()
quadrant1LMTComparisonsTargetEffectBayesfollowup()
```

As in the other quadrants, we find that the far target had faster completion times that the middle or near targets.

Finally, for washout trials, we find a significant target x block interaction.

```{r}
quadrant1WMTComparisonsEffSize()
quadrant1WMTComparisonsBayesfollowup()
```

Follow-up tests show faster completion times for the far target than the middle target in the first block, and faster completion times for the far target than the near target in the last block. Overall, these findings show that movement initiation and execution is faster for far targets.

##### Retention

To quantify retention, we compare the completion times across the first and last blocks of mirror reversed reaches in session 1, with the first block of mirror reversed reaches in session 2.

```{r}
retentionMTANOVA()
retentionMTBayesANOVA()
```

We find a significant target x block interaction.

```{r}
retentionMTComparisonMeans()
retentionMTComparisonsEffSize()
retentionMTComparisonsBayesfollowup()
```

Follow-up tests show that overall, completion times are slower for the first block of session 2 when compared to the last block of training in session 1. The only exception is the near target, which does not show a difference between these two blocks. However, completion times are faster during the first block of session 2, when compared with the first block of training in session 1. Thus, we do observe some retention for learning when considering completion times.

##### Generalization across the workspace and hands

To quantify generalization, we compare completion time across quadrants. We conduct a 3x3 (target x block) within-subjects ANOVA to compare the first set of reaches to quadrant 1 with reaches in quadrant 4. We repeat this test but instead compare quadrant 1 with quadrant 2, quadrant 1 and reaches to quadrant 1 after switching hands (Quadrant 1L).

```{r}
#Quadrant 1 vs Quadrant 4
MTANOVA2Quads(quadrantA= '1', quadrantB = '4')
MTBayesANOVA2Quads(quadrantA= '1', quadrantB = '4')

#Quadrant 1 vs Quadrant 2
MTANOVA2Quads(quadrantA= '1', quadrantB = '2')
MTBayesANOVA2Quads(quadrantA= '1', quadrantB = '2')

#Quadrant 1 vs Switch hands, Quadrant 1
MTANOVA2Quads(quadrantA= '1', quadrantB = '1L')
MTBayesANOVA2Quads(quadrantA= '1', quadrantB = '1L')
```

In comparing quadrants 1 and 4, We find a significant target x block interaction.

```{r}
quadrant1and4MTComparisonMeans()
Q1and4MTComparisonsEffSize()
Q1and4MTComparisonsBayesfollowup()
```

We find significant effects for the far target, but not the middle and near targets. However, on average, completion times during the first block of the test quadrant are shorter compared to the first block of reaches to the training quadrant.

In comparing quadrants 1 and 2, We find a significant block effect

```{r}
quadrant1and2MTComparisonMeans()
Q1and2MTComparisonsEffSize()
Q1and2MTComparisonsBayesfollowup()
```

We find significant effects for quadrant 2.

Finally in comparing quadrant 1 between the trained and untrained hands, we find a target x block effect.

```{r}
quadrant1and1LMTComparisonMeans()
Q1and1LMTComparisonsEffSize()
Q1and1LMTComparisonsBayesfollowup()
```

We do not find significant effects across hands, and even the completion times on average do not differ much between the first blocks of reaches with the trained or untrained hand.

We also compare the first block of reaches with the untrained hand to the first and last block of reaches during training in session 1.

```{r}
intermanualMTANOVA()
intermanualMTBayesANOVA()
```

We find a significant target X block interaction.

```{r}
intermanualMTComparisonMeans()
intermanualMTComparisonsEffSize()
intermanualMTComparisonsBayesfollowup()
```

Overall, we find that reaches using the untrained hand are faster than initial reaches in session 1 training. But, these are generally slower than reaches during the last block of training in session 1. This suggests partial retention.

##### Completion times during washout trials

We have already shown that far targets have faster completion times for some blocks of washout trials, compared to the other targets. We can now compare these completion times with those during the aligned reaches. We conduct a 3x3 (target x block) within-subjects ANOVA.

```{r}
RAEUntrainedHandMTANOVA()
RAEUntrainedHandMTBayesANOVA()
```

We find a target X block interaction.

```{r}
RAEUntrainedHandMTComparisonMeans()
RAEUntrainedHandMTComparisonsEffSize()
RAEUntrainedHandMTComparisonsBayesfollowup()
```

Overall, we find differences from the first block of washout, especially for the middle target.

#### Path Length

```{r}
plotCtrlGenPL()
```

##### Learned performance

We first tested for target or block effects for path length within each quadrant. Thus, we conducted 3x3 (target x block) within-subjects ANOVA for quadrants 1, 4, 2, top-up trials in quadrant 1 (Quadrant 1A in tests below), quadrant 1 after switching hands (Quadrant 1L in tests below), and washout (Quadrant 1W).

```{r}
pathlengthANOVA()
pathlengthBayesANOVA()
```

In quadrants 1, top-up trials to quadrant 1 (1A), reaches to quadrant 1 after switching hands (1L), and washout (1W), we find significant target x block interactions. We know from the plot that path length decreases across blocks. Thus, it is more interesting to test for target differences across the blocks of trials.

```{r}
#Quadrant 1
quadrant1PLComparisonsEffSize()
quadrant1PLComparisonsBayesfollowup()
#Quadrant 1A
quadrant1APLComparisonsEffSize()
quadrant1APLComparisonsBayesfollowup()
#Quadrant 1L
quadrant1LPLComparisonsEffSize()
quadrant1LPLComparisonsBayesfollowup()
#Quadrant 1W
quadrant1WPLComparisonsEffSize()
quadrant1WPLComparisonsBayesfollowup()
```

In quadrant 1, follow-up tests show that the path length for the far target is shorter compared to the middle target in all blocks, and that the middle target has a longer path length than near target in the first block. 

In quadrant 1A (top-up trials), we find shorter path lengths for the far target compared to the middle target in the first and last block, while the path lengths for the middle target were longer that the near target in the first block.

In quadrant 1L (switch to nondominant hand), we find similar results as in quadrant 1A.

In quadrant 1W (washout trials), follow up frequentist tests did not show any significant results. But, Bayesian tests show that the middle target is different than the near target in the first block.

Taken together, it seems that movement trajectories were shortest for the far target and longest for the middle target.

For quadrant 4, we observe main effects of target and block. For quadrant 2, we observe a main effect of target. We conduct follow-up tests on the target effect.

```{r}
#quadrant 4
quadrant4PLComparisonsEffSizeTargetEffect()
quadrant4PLComparisonsTargetEffectBayesfollowup()
#quadrant 2
quadrant2PLComparisonsEffSizeTargetEffect()
quadrant2PLComparisonsTargetEffectBayesfollowup()
```

In both quadrants, the target effect is accounted for by shorter path lengths for the far and near targets, compared to the middle target. Thus, path lengths support findings for completion times, where movements are faster and shorter for the far target, and slower and longer for the middle target.


##### Retention

To quantify retention, we compare the path lengths across the first and last blocks of mirror reversed reaches in session 1, with the first block of mirror reversed reaches in session 2.

```{r}
retentionPLANOVA()
retentionPLBayesANOVA()
```

We find a significant target x block interaction.

```{r}
retentionPLComparisonMeans()
retentionPLComparisonsEffSize()
retentionPLComparisonsBayesfollowup()
```

Follow-up tests show path lengths were slightly longer during the first block of session 2 when compared with the last block of training in session 1, except for the near target. Path lengths, however, are shorter during session 2 block 1, when compared with the first block of training in session 1, although this did not reach significance for the far target. Taken together, path lengths show the same pattern of results as in completion time, where we observe some retention of learning.

##### Generalization across the workspace and hands

To quantify generalization, we compare path length across quadrants. We conduct a 3x3 (target x block) within-subjects ANOVA to compare the first and last blocks of reaches to quadrant 1 with the first block of reaches reaches in quadrant 4. We repeat this test but instead compare quadrant 1 with quadrant 2, quadrant 1 and reaches to quadrant 1 after switching hands (Quadrant 1L).

```{r}
#Quadrant 1 vs Quadrant 4
PLANOVA2Quads(quadrantA= '1', quadrantB = '4')
PLBayesANOVA2Quads(quadrantA= '1', quadrantB = '4')

#Quadrant 1 vs Quadrant 2
PLANOVA2Quads(quadrantA= '1', quadrantB = '2')
PLBayesANOVA2Quads(quadrantA= '1', quadrantB = '2')

#Quadrant 1 vs Switch hands, Quadrant 1
PLANOVA2Quads(quadrantA= '1', quadrantB = '1L')
PLBayesANOVA2Quads(quadrantA= '1', quadrantB = '1L')
```

In all three tests, we find a significant target x block interaction.

```{r}
quadrantA1andBPLComparisonMeans(quadrantA='1', quadrantB='4')
QAandBPLComparisonsEffSize(quadrantA='1', quadrantB='4')
QAandBPLComparisonsBayesfollowup(quadrantA='1', quadrantB='4')
```

In comparing quadrants 1 and 4, we find significant effects for the far target, but not for the middle and near targets. However, on average, path lengths are shorter for the first block of reaches to the test quadrant, compared to the first block of reaches to the training quadrant.


```{r}
quadrantA1andBPLComparisonMeans(quadrantA='1', quadrantB='2')
QAandBPLComparisonsEffSize(quadrantA='1', quadrantB='2')
QAandBPLComparisonsBayesfollowup(quadrantA='1', quadrantB='2')
```

In comparing quadrants 1 and 2, we find significant effects for the middle target, but not the far and near targets. However, on average, path lengths are shorter for the first block of reaches to the test quadrant, compared to the first block of reaches to the training quadrant.

```{r}
quadrantA1andBPLComparisonMeans(quadrantA='1', quadrantB='1L')
QAandBPLComparisonsEffSize(quadrantA='1', quadrantB='1L')
QAandBPLComparisonsBayesfollowup(quadrantA='1', quadrantB='1L')
```
Finally, in comparing the two hands, we do not find significant effects across hands, and even the path lengths on average do not differ much between the first blocks of reaches with the trained or untrained hand.

We also compare the first block of reaches with the untrained hand to the first and last block of reaches during training in session 1.

```{r}
intermanualPLANOVA()
intermanualPLBayesANOVA()
```

We find a significant target X block interaction.

```{r}
intermanualPLComparisonMeans()
intermanualPLComparisonsEffSize()
intermanualPLComparisonsBayesfollowup()
```

Overall, we find that reaches using the untrained hand are shorter than initial reaches in session 1 training. But, these are generally longer than reaches during the last block of training in session 1. This suggests partial retention.

##### Path lengths during washout trials

We have already shown that in washout trials, theere are longer path lengths to the middle target than the near target during the first block. We now compare path lengths with those during the aligned reaches. We conduct a 3x3 (target x block) within-subjects ANOVA.

```{r}
RAEUntrainedHandPLANOVA()
RAEUntrainedHandPLBayesANOVA()
```

We find target x block interaction

```{r}
RAEUntrainedHandPLComparisonMeans()
RAEUntrainedHandPLComparisonsEffSize()
RAEUntrainedHandPLComparisonsBayesfollowup()
```

Follow-up tests show that the interaction is driven by the longer path lengths for the middle and far targets during the first block of washout compared to the first block of aligned reaches and second block of washout.


# Study 2: Supplementary analyses for the online experiment

Given the large sample we were able to collect for the online study, we also investigate for any effects related to the device they used to control the cursor (either a mouse or trackpad), and for any effects related to the participants' sex. Therefore, we split the data into mouse and trackpad users, and into males and females.

## Session 1

### Device used: Mouse vs. trackpad

#### Learning

```{r}
plotDeviceCtrl()
```

We first plot angular reach deviations across trial types for each of the target locations. We observe large variability for the mouse users due to their sample being disproportionately lower than trackpad users (Mouse N = 19, Trackpad N = 44). However, we do not really see much of a difference in learning rates and asymptotes.

First, we test for an effect of device used in the two sets of aligned trials where participants either used their dominant or nondominant hand. We conduct a 3x3x2 mixed design ANOVA, with target and block as within-subjects factors and device as a between-subjects factor.

```{r}
deviceAlignedLearningANOVA()
deviceAlignedLearningBayesANOVA()
```

We find no effects related to device used, suggestting that aligned reaches for both hands did not differ between mouse or trackpad users.

We then conducted the same 3x3x2 mixed design ANOVA during the mirror reversed trials.

```{r}
devicemirrorANOVA()
devicemirrorBayesANOVA()
```

We do not find any effects related to device used. Finally, we run the same 3x3x2 mixed design ANOVA for the washout trials.

```{r}
RAEDeviceLearningANOVA()
RAEDeviceLearningBayesANOVA()
```

We find no effects related to device used. Taken together, our results suggest that using either a mouse or trackpad to control the cursor does not lead to any differences in learning to compensate for the mirror reversed perturbation.

#### Completion time

Next, we looked into completion time between the two devices.

```{r}
plotDeviceCtrlMT()
```

We conduct the same 3x3x2 (target x block x device) mixed design ANOVA as in learning, but we now have completion time as the dependent variable.

```{r}
deviceAlignedMTANOVA()
deviceAlignedMTBayesANOVA()
```

We find no device-related effects. We repeat the test for the mirror reversed trials.

```{r}
deviceMirrorMTANOVA()
deviceMirrorMTBayesANOVA()
```

We find no device-related effects. Finally, we conduct the test for washout trials.

```{r}
deviceRAEMTANOVA()
deviceRAEMTBayesANOVA()
```

We find a device x block interaction in the frequentist test, which did not hold up in the Bayesian test. Overall, completion time did not differ between mouse and trackpad users.

#### Path length

We also looked into path lengths for the two devices.

```{r}
plotDeviceCtrlPL()
```

We then repeat the same set of ANOVAs as in the section above, but use path length as the dependent variable. We first look into the aligned trials.

```{r}
deviceAlignedPLANOVA()
deviceAlignedPLBayesANOVA()
```

We find no device-related effects for the dominant hand, but find a main effect of device and a target x block x device interaction for the nondominant hand. We conduct follow-up tests on the main effect of device, regardless of target or block.

```{r}
deviceAlignedPLComparisons()
```

We find longer path lengths for mouse users, than trackpad users.

Next, we test for effects in the mirror reversed trials.

```{r}
deviceMirrorPLANOVA()
deviceMirrorPLBayesANOVA()
```

We find no device-related effects. We then test for an effect during washout trials.

```{r}
deviceRAEPLANOVA()
deviceRAEPLBayesANOVA()
```

We find no device-related effects. Overall, we only found path length differences between mouse and trackpad users in the aligned trials using the nondominant hand. This difference could be due to participants not being used to controlling the mouse with their nondominant hand, while it is easier to use the trackpad with both hands.

### Sex differences: Males vs. females

We repeat the same set of analyses but now split the data according to males (N =18) and females (N = 44). Note that one participant did not identify as either male or female, so they are not included in the comparisons below.

#### Learning

```{r}
plotSexCtrl()
```

The disproportionately smaller sample for males contribute to the variability we observe in their data. We first conduct a 3x3x2 (trackpad x block x sex) mixed design ANOVA, with trackpad and block as within-subjects factors and sex as a between-subjects factor, for the aligned trials for both hands.

```{r}
sexAlignedLearningANOVA()
sexAlignedLearningBayesANOVA()
```

We do not find any sex-related effects. Next, we conduct the same test for mirror reversed reaches.

```{r}
sexmirrorANOVA()
sexmirrorBayesANOVA()
```

There are no sex-related effects. Finally, we test washout trials.

```{r}
RAESexLearningANOVA()
RAESexLearningBayesANOVA()
```

We do not find sex-related effects. Overall, learning the mirror reversal did not differ between males and females.

#### Completion time

```{r}
plotSexCtrlMT()
```


Next, we test for sex-related effects with completion times across the different trial types. First, we test aligned trials.

```{r}
sexAlignedMTANOVA()
sexAlignedMTBayesANOVA()
```

We do not find any effects of sex. We then look into the mirror reversed trials.

```{r}
sexMirrorMTANOVA()
sexMirrorMTBayesANOVA()
```

We find a main effect of sex. 

```{r}
sexMirrorMTComparisons()
```

Follow up tests show that regardless of target or block, males have faster completion times on average during perturbed reaches.

Finally, we test for washout trials.

```{r}
sexRAEMTANOVA()
sexRAEMTBayesANOVA()
```

We find a main effect of sex and a sex x block interaction.

```{r}
sexRAEMTComparisonsEffSize()
sexRAEMTBayesfollowup()
```

Follow-up frequentist tests do not show any significant effects. But Bayesian tests show anecdotal evidence that males continue to move faster after perturbation training. These results suggest that males initiate and execute movements faster than females during perturbed and washout trials, even though no sex differences were observed in aligned baseline reaches.

#### Path length

```{r}
plotSexCtrlPL()
```

We repeat the same tests and use path length as the dependent variable.

```{r}
sexAlignedPLANOVA()
sexAlignedPLBayesANOVA()
```

We do not find sex-related effects in the aligned trials. Next, we test for mirror reversed trials.

```{r}
sexMirrorPLANOVA()
sexMirrorPLBayesANOVA()
```

There are no sex-related effects. Finally, we test for washout trials.

```{r}
sexRAEPLANOVA()
sexRAEPLBayesANOVA()
```

We do not find any sex effects. Thus, although males move faster than females, the overall trajectory of their reaches do not differ.

## Session 2

We also conducted tests that compared device used and sex for reaches in the second session.

### Device used: Mouse vs. trackpad

In session 2, there were less mouse users (N = 9) than trackpad users (n = 39), which is probably contributing to the large variability observed in the plots.

#### Learning

```{r}
plotDeviceCtrlGen()
```

We test for device effects for reaches within each quadrant. We conduct a 3x3x2 (target x block x device) mixed design ANOVA, with target and block as within-subjects factors and device as a between-subjects factor. We repeat this test for quadrants 1, 4, 2, top up quadrant 1 trials, and quadrant 1 trials after switching hands.

```{r}
deviceLearningGenANOVA()
deviceLearningGenBayesANOVA()
```

We find a significant target x block x device interaction in quadrant 1, and a significant device x target interaction in quadrant 2. However, both interactions did not hold up in the Bayesian tests.

```{r}
deviceLearningGenQ1ComparisonsEffSize()
deviceLearningGenQ1Bayesfollowup()
```

Follow-up tests in quadrant 1 show that there are no differences between devices across blocks and targets. However, Bayesian test comparing devices in the near target during the last block show anecdotal evidence for a difference. In the plot, this is seen with how mouse users were over compensating during the last block.

```{r}
deviceLearningGenQ2ComparisonsEffSize()
deviceLearningGenQ2Bayesfollowup()
```

Follow-up tests for quadrant 2 show no effects. But, Bayesian follow-up test on the near target show anecdotal evidence of a difference between devices. In the plot, this is again observed with how mouse users are overcompensating.

Next, we check washout trials.

```{r}
deviceWashoutLearningANOVA()
deviceWashoutLearningBayesANOVA()
```

We do not find any device effects. Thus, it seems that overall learning between mouse and trackpad users are the same, but mouse users tend to overcompensate for the near target.

#### Completion time

```{r}
plotDeviceCtrlGenMT()
```

We conduct the same 3x3x2 mixed design ANOVA with completion time as the dependent variable. We conduct this test for reaches to quadrants 1, 4, 2, top-up quadrant 1 trials, quadrant 1 trials after switching hands, and washout trials.

```{r}
deviceGenmovementtimeANOVA()
deviceGenmovementtimeBayesANOVA()
```

We find a device x target interaction for quadrants 2 and quadrant 1 after switching hands (1L). We also find a target x block x device interaction for quadrant 1 top-up trials (1A).

```{r}
deviceMTGenQ2ComparisonsEffSize()
deviceMTGenQ2Bayesfollowup()
```

Quadrant 2 follow-up tests only show anecdotal evidence of a device effect for the near target.

```{r}
deviceMTGenQ1LComparisonsEffSize()
deviceMTGenQ1LBayesfollowup()
```

Follow-up tests for Quadrant 1 after switching hands did not reveal any device effects.

```{r}
deviceMTGenQ1AComparisonsEffSize()
deviceMTGenQ1ABayesfollowup()
```

Follow-up tests on quadrant 1 top-up trials only show anecdotal evidence of a device effect for the far target in the second block, and the near target in the second block. In both cases, we see in the plot that these are when mouse users were moving a bit faster than trackpad users. Thus, there is only a small amount of evidence showing that mouse users initiate and execute movements faster than trackpad users.

#### Path length

```{r}
plotDeviceCtrlGenPL()
```

We repeat the same tests and have path length as the dependent variable.

```{r}
deviceGenpathlengthANOVA()
deviceGenpathlengthBayesANOVA()
```

We do not find any device effects for path length in reaches to all quadrants.

### Sex: Males vs. females

In session 2 the sample for males (N = 11) was smaller than the sample for females (N = 36). One participant identified as neither and was excluded from the comparisons below.

#### Learning

```{r}
plotSexCtrlGen()
```

We conduct the same 3x3x2 mixed design ANOVA as in previous sections, but now we are testing for an effect of sex.

```{r}
sexLearningGenANOVA()
sexLearningGenBayesANOVA()
```

We do not find any sex effects. We then test washout trials.

```{r}
sexWashoutLearningANOVA()
sexWashoutLearningBayesANOVA()
```

We also do not find any effect of sex.

#### Completion time

```{r}
plotSexCtrlGenMT()
```

Next we repeat the same tests but now have completion time as the dependent variable.

```{r}
sexGenmovementtimeANOVA()
sexGenmovementtimeBayesANOVA()
```

We find no sex effects for completion time.

#### Path length

```{r}
plotSexCtrlGenPL()
```

Then we conduct tests with path length as the dependent variable.

```{r}
sexGenpathlengthANOVA()
sexGenpathlengthBayesANOVA()
```

We do not find any sex effects for path length.

Overall, in considering all analyses for device and sex comparisons, we find some differences but these are not consistent. These are likely due to the uneven sample sizes, where we have less mouse users and males in our data. Some of the differences we find involve mouse users overcompensating for the near target, and males having faster completion times than females. However, these differences were small and are likely not meaningful effects.

